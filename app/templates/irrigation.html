{% extends "base.html" %}
{% block title %}Riego{% endblock %}

{% block content %}

<h2>ðŸ’§ Zonas de riego</h2>

<!-- RIEGOS PROGRAMADOS -->
<div class="card">
  <h3>Nuevo riego programado</h3>

  <div class="form-grid">

    <label>Sector</label>
    <select id="sector">
      <option value="1">Sector 1</option>
      <option value="2">Sector 2</option>
      <option value="3">Sector 3</option>
    </select>

    <label>Fecha</label>
    <input type="date" id="date">

    <label>Hora inicio</label>
    <input type="time" id="start">

    <label>Hora fin</label>
    <input type="time" id="end">

    <button onclick="createSchedule()">Guardar</button>

  </div>
</div>


<!-- ZONAS MANUALES -->
<div class="zones-grid">
  {% for z in zones %}
  <div class="zone-card" id="zone-{{ z[0] }}">

    <div class="valve-wrapper">
      <img class="valve-icon"
           src="{{ url_for('static', filename='img/valve.png') }}">
    </div>

    <h3>{{ z[1] }}</h3>

    <div class="zone-status">APAGADO</div>
    <div class="zone-timer" id="timer-{{ z[0] }}">00:00</div>

    <button onclick="toggleZone({{ z[0] }})">
      Activar / Desactivar
    </button>

  </div>
  {% endfor %}
</div>


<!-- HISTÃ“RICO -->
<div class="card">
  <h3>Ãšltimos riegos</h3>

  {% if records %}
  <table>
    <tr>
      <th>Sector</th>
      <th>Inicio</th>
      <th>Fin</th>
      <th>Tipo</th>
    </tr>

    {% for r in records %}
    <tr>
      <td>{{ r[0] }}</td>
      <td>{{ r[1] }}</td>
      <td>{{ r[2] }}</td>
      <td>
        {% if r[3] == "manual" %}
          ðŸ”µ Manual
        {% else %}
          ðŸŸ¢ Programado
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
    <p>No hay registros todavÃ­a.</p>
  {% endif %}
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/irrigation.js') }}"></script>
{% endblock %}
